# 图片懒加载

## 题目

设计一个 H5 页面的图片懒加载功能

## 要点

第一，`<img>` 要使用 `data-src`（或其他属性）记录 src 。还有，loading.gif 要自定义，要配合实际图片的尺寸。

```html
<img src="./img/loading.gif" data-src="./img/animal1.jpeg"/>
```

第二，可以使用 `Element.getBoundingClientRect()` 来判断当前元素的位置

* `getBoundingClientRect().top`可以帮我们获得图片相对于视口距离顶部的距离
* `window.innerHeight`可以帮我们获得视口的高度(一般来说，对一个设备来说是一个固定值!)

第三，页面滚动实时计算，注意**节流**

```js
    const images = document.querySelectorAll('img')
    let n = 0
    let lazyload = (e) => {
      for (let i = n; i < images.length; i++) {
        const imageTop = images[i].getBoundingClientRect().top
        if (imageTop < window.innerHeight) {
          images[i].setAttribute('src', images[i].getAttribute('data-src'))
          n = i + 1
        }
      }
      console.log('scroll触发');
    }

```
