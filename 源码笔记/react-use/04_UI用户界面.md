### useFullscreen


[useFullscreen docs](https://link.juejin.cn?target=https%3A%2F%2Fstreamich.github.io%2Freact-use%2F%3Fpath%3D%2Fstory%2Fui-usefullscreen--docs "https://streamich.github.io/react-use/?path=/story/ui-usefullscreen--docs") | [useFullscreen demo](https://link.juejin.cn?target=https%3A%2F%2Fstreamich.github.io%2Freact-use%2F%3Fpath%3D%2Fstory%2Fui-usefullscreen--demo "https://streamich.github.io/react-use/?path=/story/ui-usefullscreen--demo")

> Display an element full-screen, optional fallback for fullscreen video on iOS.
> 实现全屏

主要使用 [screenfull](https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fsindresorhus%2Fscreenfull "https://github.com/sindresorhus/screenfull") npm 包实现.

```tsx
const useFullscreen = (
  ref: RefObject<Element>,
  enabled: boolean,
  options: FullScreenOptions = {}
): boolean => {
  const { video, onClose = noop } = options;
  const [isFullscreen, setIsFullscreen] = useState(enabled);
  // const useIsomorphicLayoutEffect = isBrowser ? useLayoutEffect : useEffect;
  useIsomorphicLayoutEffect(() => {
    if (!enabled) {
      return;
    }
    if (!ref.current) {
      return;
    }

    const onWebkitEndFullscreen = () => {
      if (video?.current) {
        // 关闭事件监听
        off(video.current, 'webkitendfullscreen', onWebkitEndFullscreen);
      }
      onClose();
    };

    const onChange = () => {
      if (screenfull.isEnabled) {
        const isScreenfullFullscreen = screenfull.isFullscreen;
        setIsFullscreen(isScreenfullFullscreen);
        if (!isScreenfullFullscreen) {
          onClose();
        }
      }
    };
    // 是否支持全屏
    if (screenfull.isEnabled) {
      try {
        // .request(element, options?) Make an element fullscreen. Accepts a DOM element and FullscreenOptions.The default element is <html>. 
        // If called with another element than the currently active, it will switch to that if it's a descendant.
        screenfull.request(ref.current);
        setIsFullscreen(true);
      } catch (error) {
        onClose(error);
        setIsFullscreen(false);
      }
      screenfull.on('change', onChange);
    } else if (video && video.current && video.current.webkitEnterFullscreen) {
      video.current.webkitEnterFullscreen();
      on(video.current, 'webkitendfullscreen', onWebkitEndFullscreen);
      setIsFullscreen(true);
    } else {
      onClose();
      setIsFullscreen(false);
    }

    return () => {
      setIsFullscreen(false);
      if (screenfull.isEnabled) {
        try {
          screenfull.off('change', onChange);
          screenfull.exit();
        } catch {}
      } else if (video && video.current && video.current.webkitExitFullscreen) {
        off(video.current, 'webkitendfullscreen', onWebkitEndFullscreen);
        video.current.webkitExitFullscreen();
      }
    };
  }, [enabled, video, ref]);

  return isFullscreen;
};

```
